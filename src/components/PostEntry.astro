---
import { CDN_URL } from '../lib/constant';

// PostEntry.astro
interface Props {
  id: string;
  title: string;
  subtitle: string;
  coverImage: string; // Changed from any/ImageMetadata to string
  date: Date;
  url: string;
}

const { id, title, subtitle, coverImage, url, date } = Astro.props;

// 1. Create an optimized thumbnail URL
// We request 1200px width, 80% quality, and WebP format 
const thumbnailUrl = `${CDN_URL}${coverImage}?w=1024&q=80`;

const formattedDate = date.toLocaleDateString('sv-SE');
---

<a href={url} class="post-entry grid grid-cols-12 gap-4 group cursor-pointer border-t border-brand-black py-8 last:border-b items-start">
    
    <div class="col-span-2 md:col-span-1 flex flex-col gap-1">
        <div class="overflow-hidden">
            <span class="reveal-item inline-block font-mono text-[10px] font-bold text-brand-red">{id}</span>
        </div>

        <div class="overflow-hidden">
            <span class="reveal-item inline-block font-mono text-[10px] opacity-40 leading-none">{formattedDate}</span>
        </div>
    </div>

    <div class="col-span-10 md:col-span-8 space-y-3">
        <div class="overflow-hidden">
            <h2 class="reveal-item text-3xl font-black uppercase leading-[0.85] tracking-tightest group-hover:text-brand-red transition-colors duration-300">
                {title}
            </h2>
        </div>
        <div class="overflow-hidden">
            <p class="reveal-item text-sm font-bold uppercase leading-tight opacity-70 max-w-xl">
                {subtitle}
            </p>
        </div>
    </div>

    <div class="hidden md:block md:col-span-3">
        <div class="overflow-hidden aspect-[4/3] border border-brand-black/5 bg-neutral-100">
            <img 
                src={thumbnailUrl} 
                alt={title} 
                width={1024} 
                height={1024}
                loading="lazy"
                decoding="async"
                class="reveal-img w-full h-full object-cover grayscale contrast-125 group-hover:grayscale-0 group-hover:scale-110" 
            />
        </div>
    </div>
</a>